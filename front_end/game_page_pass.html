<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- <link rel="stylesheet" href="/game.css"> -->
    <link rel="icon" href="../images/logo-02.svg" />
    <title>良耕野菜-小知識通關頁面</title>
    <link rel="icon" href="../images/logo-02.svg" />
    <link rel="stylesheet" href="../css/style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <script src="../js/jquery-3.6.0.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
  </head>
  <body id="game_page" onload="ifMember()">
    <header class="header">
      <!-- 手機板header -->
      <div class="fixed_top"></div>
      <!-- 手機板header結束 -->
      <div class="menu_fixed"></div>
      
    <div class="menu">
      <div class="logo_img">
        <a href="./index.html">
          <img src="../images/logo.svg" alt="logo" />
        </a>
      </div>
      <div class="page_list">
        <a href="./event.html">農村體驗</a>
        <a href="./fruit_box.html">客製蔬果箱</a>
        <a class="on_page" href="./game.html">蔬果知識小遊戲</a>
        <a href="./aboutUs.html">關於我們</a>
        <a href="./q_a.html">問與答</a>
        <a href="./shopping_page.html">新鮮蔬果</a>
      </div>
    </div>
    <div class="title">
      <div class="title_btn">
        <button class="comm_us">
          聯絡我們 <img src="../images/cotact_us.svg" width="25px" alt="" />
        </button>
        <a class="buy_now">
          立即買<img src="../images/buy_now.svg" width="25px" alt="" />
        </a>
      </div>
      <div class="title_pic">
        <img
          src="../images/member/member_01.jpg"
          alt="checkout_pic"
          style="padding-bottom: 100px;"
        />
        <span class="bkc_black"></span>
        <h1>蔬果知識小遊戲</h1>
      </div>

      <!-- 漢堡彈窗 -->
      <div class="jump_hamburger_block"></div>
      <!-- 漢堡彈窗結束 -->

    <!-- 聯絡我們彈窗 -->
    <div class="index_contact_box"></div>
    <!-- 聯絡我們彈窗結束 -->

    <!-- 購物車彈窗  -->
    <div class="cart_bk"></div>
    <div class="header_shopping_cart"></div>
    <!-- 購物車彈窗結束  -->

      <!-- 滾輪  -->
    <div class="scrollbar" id="style-6">
      <div class="force-overflow"></div>
    </div>

  </header>

    <div id="game_title">
        <h2 class="game_title">蔬果知識小遊戲</h2>
    </div>
    <section class="game_play_border_PassandDefeat" id="test_block">
      <div id="game_decorate_testNumberCircle_2">
          <h1 id="inside_testNumber">{{testNumber}}</h1>
      </div>
          <img src="../images/game/cabage_group.svg" alt="" class="game icon_1" />
          <img src="../images/game/cabage_group.svg" alt="" class="game icon_2" />
          <img src="../images/game/cabage_group.svg" alt="" class="game icon_3" />
      <!-- <img src="./images/game/game_img_Tomato.png" alt="" class="game icon_4" /> -->
      <div id="count"><h1>{{time}}</h1></div>
      <div class="game_test_2">
          <img src="../images/game/game_img_Tomato.svg" alt="" id="game_test" />
      </div>
      <div id="game_question" class="animate__animated animate__bounceInDown">
        <h2 id="ifnotlogin" v-html="ifnotlogin">
        </h2>
        <h2 id="iflogin" v-html="ifnotlogin">
        </h2>
      </div>
      <div id="game_bottom_part_PassandDefeat">
        <div id="game_answer">
            <button type="submit" id="submit_1" @click="goLogin()" >
                <div id="action1">{{signmember}}</div>
                <img src="../images/game/rightArrow.svg" alt="" id="rightArrow" />
            </button>
            <button type="submit" id="submit_2">
                <img src="../images/game/leftArrow.svg" alt="" id="leftArrow" />
                <div id="action2" @click="goLogin()">
                  {{action2}}
                </div>
                <div id="action2ifLogin" @click="doCheck()">
                  {{action2ifLogin}}
                </div>
            </button>
        </div>
        <img
          src="../images/game/game_img_Farmer.svg"
          alt=""
          class="decorate icon_11"
        />
      </div>
      <!-- 用js去寫換圖 -->
      <!-- button在外層直接換內層 -->
    </section>
    
      

    <section id="game_slideshow_step_PassandDefeat">
        <div id="game_slideshow">
            <img
              src="../images/game/game_scroll_1.png"
              class="game_slideshow"
              alt=""
            />
            <img
              src="../images/game/game_scroll_2.png"
              class="game_slideshow"
              alt=""
            />
            <img
              src="../images/game/game_scroll_3.png"
              class="game_slideshow"
              alt=""
            />
            <img
              src="../images/game/game_scroll_4.png"
              class="game_slideshow"
              alt=""
            />
            <img
              src="../images/game/game_scroll_5.png"
              class="game_slideshow"
              alt=""
            />
        </div>
    </section>
    <footer class="footer_bg">
      <div class="footer">
        <button class="go_top" id="go_top">
          <img src="../images/top.svg" alt="top" />
        </button>
        <div class="footer_logo">
          <a href="./index.html">
            <img src="../images/logo.svg" alt="logo" />
          </a>
        </div>
        <div class="footer_center">
          <h4>電話:02-26938800</h4>
          <h5>營業時間: 星期二至星期日(10:00 - 17:00)</h5>
          <h5>※農曆過年假期本農場也公休 網路接單為24小時</h5>
          <h5>※當日訂單最晚收到17:00</h5>
          <h5>(17:00後下單視為隔日下單)</h5>
          <div class="btn_pos">
            <button class="mail_btn">
              <img src="../images/mail.svg" alt="mail">MAIL
            </button>
          </div>
          <div class="footer_icon">
            <img src="../images/icon-fb.svg" alt="fb" />
            <img src="../images/icon-line.svg" alt="line" />
            <img src="../images/icon-ig.svg" alt="ig" />
          </div>
        </div>
        <div class="footer_right">
          <div class="right_main">
            <a href="./index.html">首頁</a>
            <a href="./event.html">農村體驗</a>
            <a href="./game.html">蔬果知識小遊戲</a>
            <a href="./aboutUs.html">關於我們</a>
            <a href="./q_a.html">問與答</a>
          </div>
          <div class="right_buy">
            <a href="./fruit_box.html">客製蔬果箱</a>
            <a href="./shopping_page.html">蔬菜</a>
            <a href="./shopping_page.html">水果</a>
          </div>
        </div>
      </div>
    </footer>

    <script src="../js/right_nav_bar.js"></script>
    <script src="../js/shopping_cart.js"></script>
    <script src="../js/header.js"></script>
    <script>

      var test_block=new Vue({
        el: "#test_block",
        data:{
          isBtnDisabled:true,
          testNumber:'通關',
          time:'時間到',
          ifnotlogin:' 恭喜!通過了蔬菜們的考驗。請註冊會員，或登入會員進行扭蛋遊戲',
          iflogin:'恭喜!通過了蔬菜們的考驗。請進行扭蛋遊戲!',
          signmember:'註冊會員',
          action2:'登入會員，扭蛋去',
          action2ifLogin:' 會員扭蛋去',

        },
        methods:{
          //AJAX 確認會員資格
           doCheck(){
            $.ajax({//jQuery-AJAX語法            
                method: 'POST',//方式
                url: '../php/check_member.php',//API伺服器  
                data:{},
                dataType: 'text', //傳送的不是JSON檔，用TEXT型態就可以了       
                success: function (response) {//response是由php回傳
                    //更新html內容
                    if(response=="yes"){
                      alert("親愛的會員，歡迎你小試身手來轉蛋");
                      location.href = './game_page_lotteryStart.html';  
                    }else{    
                      location.href ='./shopping_page.html';
                      alert("您尚有購物金未使用，請購物"); 
                    }
                },
                error: function(exception) {//error是代表AJAX response的error
                    console.log(exception);
                }
            });
          },
            goLogin(){
              let site_now = JSON.parse(sessionStorage.getItem("site_now"));
              if(site_now){
                  site_now = [];
                  site_now.push(location.href);  
              }else{
                sessionStorage.setItem('site_now', JSON.stringify(location.href));
              }
              location.href = './login.html';
            }
        }

      });




      // //AJAX 確認會員資格
      // function doCheck(){
      //   // alert('aaa');
      //   $.ajax({//jQuery-AJAX語法            
      //       method: 'POST',//方式
      //       url: '../php/check_member.php',//API伺服器  
      //       data:{},
      //       dataType: 'text', //傳送的不是JSON檔，用TEXT型態就可以了       
      //       success: function (response) {//response是由php回傳
      //           //更新html內容
      //           if(response=="yes"){
      //             // location.href ='./game_page_lotteryStart.html';   
      //             let site_now = JSON.parse(sessionStorage.getItem("site_now"));
      //                 if(site_now){
      //                   site_now = [];
      //                   site_now.push('./game_page_lotteryStart.html');
      //                   alert("親愛的會員，歡迎你小試身手來轉蛋");  
      //                 }else{
      //                   sessionStorage.setItem('site_now', JSON.stringify(location.href));
      //                 }
      //           }else if(response=="used"){    
      //             // (response=no)
      //            location.href ='./shopping_page.html';
      //            alert("您尚有購物金未使用，請購物"); 
      //           }else{
      //             location.href ='./login.html';
      //             alert("請先登入會員"); 
      //           }
                
      //       },
      //       error: function(exception) {//error是代表AJAX response的error
      //           console.log(exception);
      //       }
      //   });

      // }
        //判斷是否會員，如果是直接進入扭蛋頁

      //Slider
      $("#game_slideshow").each(function() {
        let slideImgs = $(this).find("img");

        let slideImgsCount = slideImgs.length;
        let currentIndex = 0;
        // .eq(n)第幾個元素，從 0 開始，0 代表第一個。以此類推。
        slideImgs.eq(currentIndex).fadeIn();

        setInterval(showSlider, 4000);

        function showSlider() {
          let nextIndex = (currentIndex + 1) % slideImgsCount;
          slideImgs.eq(currentIndex).fadeOut();
          slideImgs.eq(nextIndex).fadeIn();
          currentIndex = nextIndex;
        }
      });

      //     // ====以下為共用====
      //     // 控制HEADER裡的黃色NAV區塊
      // var menu = document.getElementsByClassName("menu")[0];
      // document.addEventListener("scroll", function () {
      //   menu.style.top = (0 - (scrollY)) + "px";
      // });

      // // 漢堡選單
      // $('.ham').on("click", function () {
      //   $('.jump_hamburger_block').fadeToggle();
      //   $('.ham_top').toggleClass('ham_top_move');
      //   $('.ham_middle').toggleClass('ham_middle_move')
      //   $('.ham_bottom').toggleClass('ham_bottom_move');
      // })

      
      function ifMember(){
        $.ajax({
              method: 'POST',
              url: '../php/ifMember.php',
              data:{},
              dataType: 'text',
              success: function(response) {
                console.log(response);
                if(response == 'yes'){
                    $('.nav_block_log > span').text('會員中心');
                    $('.login').click(function(){
                      window.location.href = 'member.html';
                    });
                    $('#submit_1').css("display","none");
                    $('#action2').css("display","none");
                    $('#submit_2ifLogin').css("display","block");
                    $('#ifnotlogin').css("display","none");
                    $('#iflogin').css("display","block");
                }else{
                    $('.login').click(function(){
                      window.location.href = 'login.html';
                    });
                    $('#iflogin').css("display","none");
                    $('#action2ifLogin').css("display","none");
                }
              },
              error: function(exception) {
                    console.log(exception)
                    alert("發生錯誤: " + exception.status);
              },
        });  
      }


      // 回頁首
      $("#go_top").on("click", function(e) {
        e.preventDefault();
        $("html, body").animate(
          {
            scrollTop: 0,
          },
          750
        );
      });
    </script>
  </body>
</html>
